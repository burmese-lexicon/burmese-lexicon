(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"resources/elements/profile-page":function(e,r,t){"use strict";t.r(r),function(e){t.d(r,"ProfilePage",function(){return p});var i=t(91),o=t(37),a=t("aurelia-framework"),n=t("aurelia-validation"),l=function(e,r,t,i){var o,a=arguments.length,n=a<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,r,t,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(n=(a<3?o(n):a>3?o(r,t,n):o(r,t))||n);return a>3&&n&&Object.defineProperty(r,t,n),n},s=function(e,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,r)},u=function(r,t,i,o){return new(i||(i=e))(function(e,a){function n(e){try{s(o.next(e))}catch(e){a(e)}}function l(e){try{s(o.throw(e))}catch(e){a(e)}}function s(r){r.done?e(r.value):new i(function(e){e(r.value)}).then(n,l)}s((o=o.apply(r,t||[])).next())})},c=function(e,r){var t,i,o,a,n={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;n;)try{if(t=1,i&&(o=i[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return n.label++,{value:a[1],done:!1};case 5:n.label++,i=a[1],a=[0];continue;case 7:a=n.ops.pop(),n.trys.pop();continue;default:if(!(o=(o=n.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){n=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(6===a[0]&&n.label<o[1]){n.label=o[1],o=a;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(a);break}o[2]&&n.ops.pop(),n.trys.pop();continue}a=r.call(e,n)}catch(e){a=[6,e],i=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},p=function(){function e(e,t,i){this.authService=e,this.usersApi=t,this.validationControllerFactory=i,this.loading=!0,this.publicPhotoURL=null,this.imageError=!0,this.controller=i.createForCurrentScope(),this.controller.validateTrigger=n.validateTrigger.changeOrBlur,n.ValidationRules.ensure(function(e){return e.publicName}).displayName("Display Name").maxLength(r.MAX_NAME_LENGTH).required().ensure(function(e){return e.publicPhotoURL}).displayName("Photo url").matches(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/).withMessage("Photo url needs to be a valid image url").on(this)}return r=e,e.prototype.created=function(){return u(this,void 0,void 0,function(){var e,r;return c(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),[4,this.usersApi.getPublicUserInfo(this.authService.userId)];case 1:return e=t.sent(),r=e.data(),this.publicName=r.name,this.publicPhotoURL=r.photoURL,[3,4];case 2:return t.sent(),this.loadingError="There was an error loading your profile. Please try again later",[3,4];case 3:return this.loading=!1,[7];case 4:return[2]}})})},e.prototype.submit=function(){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:this.formState="loading",e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.usersApi.setPublicUserInfo(this.authService.userId,{name:this.publicName,photoURL:this.publicPhotoURL})];case 2:return e.sent(),this.formState="success",[3,4];case 3:return e.sent(),this.formState="error",[3,4];case 4:return[2]}})})},e.prototype.handleImageError=function(){this.imageError=!0},e.prototype.handleImageLoad=function(){this.imageError=!1},Object.defineProperty(e.prototype,"user",{get:function(){return this.authService.user},enumerable:!0,configurable:!0}),e.MAX_NAME_LENGTH=20,e=r=l([a.b,s("design:paramtypes",[o.a,i.a,n.ValidationControllerFactory])],e);var r}()}.call(this,t(11))},"resources/elements/profile-page.html":function(e,r,t){e.exports='<template> <require from=./profile-page.scss></require> <div if.bind=loading class="ui active inverted dimmer"> <div class="ui loader"></div> </div> <form class="ui form ${controller.errors.length ? \'error\' : \'\'} ${formState}" submit.delegate=submit()> <div class="field required disabled"> <label>Email</label> <input type=email name=email value.bind=user.email placeholder=myemail@domain.com> </div> <div class="ui divider"></div> <h1>Public Info</h1> <ul if.bind="formState !== \'error\' && controller.errors" class="ui error message"> <li repeat.for="error of controller.errors"> ${error.message} </li> </ul> <div class="ui success message"> Your profile has been updated successfully. </div> <div class="ui error message" if.bind=\'formState === "error"\'> There was an error updating your profile. Please try again later. </div> <em>Info under this section is publicly visible on your contributions.</em> <div class="field required"> <label>Display Name</label> <input type=text name=name value.bind="publicName & debounce & validate" placeholder=name> </div> <div class=field> <label>Photo Url</label> <input type=url name=photoURL value.bind="publicPhotoURL & debounce & validate" placeholder=https://myprofilepic.jpg> <img show.bind=!imageError class="ui circular image" src.bind=publicPhotoURL error.trigger=handleImageError() load.trigger=handleImageLoad()> </div> <button class="ui button" type=submit>Submit</button> </form> </template> '},"resources/elements/profile-page.scss":function(e,r,t){(e.exports=t(53)(!1)).push([e.i,".profile-page form{text-align:left}.profile-page form img{margin-top:1em;width:6em;height:6em}",""])}}]);
//# sourceMappingURL=profile.84ea5ffb094f77b79088.bundle.map