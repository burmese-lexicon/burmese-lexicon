(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"resources/elements/request-word-page":function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"RequestWordPage",function(){return p});var i=r(63),n=r("aurelia-event-aggregator"),o=r(29),s=r(35),a=r(45),l=r("aurelia-framework"),u=r("aurelia-validation"),c=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(t,r,i,n){return new(i||(i=e))(function(e,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(t){t.done?e(t.value):new i(function(e){e(t.value)}).then(s,a)}l((n=n.apply(t,r||[])).next())})},f=function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=i[2&o[0]?"return":o[0]?"throw":"next"])&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[0,n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},p=function(){function e(e,t,r,i,n,o){this.validationControllerFactory=e,this.validator=t,this.wordsApi=r,this.authService=i,this.router=n,this.ea=o,this.formState="",this.MAX_WORD_LENGTH=20,this.isFormValid=!1,this.controller=e.createForCurrentScope(t),this.controller.validateTrigger=u.validateTrigger.changeOrBlur,this.controller.subscribe(this.updateIsFormValid.bind(this)),u.ValidationRules.ensure(function(e){return e.word}).matches(/^[\u1000-\u109F]*$/).withMessage("${$displayName} can only have Burmese letters and no spaces.").maxLength(this.MAX_WORD_LENGTH).required().on(this)}return e.prototype.updateIsFormValid=function(e){var t=this;this.validator.validateObject(this).then(function(e){t.isFormValid=e.every(function(e){return e.valid})}),this.formState=""},e.prototype.submit=function(){return h(this,void 0,void 0,function(){var e,t=this;return f(this,function(r){switch(r.label){case 0:if(!this.authService.verified)return this.ea.publish(new i.a),[2];this.formState="loading",this.serverValidateResult&&this.controller.removeError(this.serverValidateResult),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,this.wordsApi.getWord(this.word)];case 2:return r.sent().exists?(this.serverValidateResult=this.controller.addError("This word already exists.",this),this.formState="",[2]):[4,this.wordsApi.isRequestedWord(this.word)];case 3:return r.sent()?(this.serverValidateResult=this.controller.addError("This word is already requested.",this),this.formState="",[2]):[4,this.wordsApi.requestWord(this.word,this.authService.userId)];case 4:return r.sent(),this.formState="success",window.setTimeout(function(){return t.router.navigateToRoute("requested-words")},3e3),[3,6];case 5:return e=r.sent(),console.error(e),this.formState="error",[3,6];case 6:return[2]}})})},e=c([l.b,d("design:paramtypes",[u.ValidationControllerFactory,u.Validator,a.a,s.a,o.d,n.a])],e)}()}.call(this,r(11))},"resources/elements/request-word-page.html":function(e,t){e.exports="<template>\n  <form class=\"ui form ${controller.errors.length ? 'error' : ''} ${formState}\" submit.delegate='submit()'>\n    <h1 class='ui header'>Request a new word</h1>\n    <ul if.bind=\"formState !== 'error' && controller.errors\" class='ui error message'>\n      <li repeat.for=\"error of controller.errors\">\n        ${error.message}\n      </li>\n    </ul>\n    <div class='ui success message'>\n      The word ${word} has been added successfully.\n    </div>\n    <div class='ui error message' if.bind='formState === \"error\"'>\n      There was an error adding the word. Please try again later.\n    </div>\n    <div class='required field'>\n      <label style='text-align: left;'>Word</label>\n      <input type=\"text\" name=\"word\" placeholder=\"စကားလုံး\" value.bind='word & validate' required>\n    </div>\n    <button class=\"ui button ${!isFormValid ? 'disabled' : ''}\" type=\"submit\">Submit</button>\n  </form>\n</template>\n"}}]);
//# sourceMappingURL=request-word.e7ca5a693c417bef15f1.bundle.map