(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"resources/elements/profile-page":function(e,r,t){"use strict";t.r(r),function(e){t.d(r,"ProfilePage",function(){return p});var n=t(80),i=t(35),o=t("aurelia-framework"),a=t("aurelia-validation"),l=function(e,r,t,n){var i,o=arguments.length,a=o<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,r,t,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(r,t,a):i(r,t))||a);return o>3&&a&&Object.defineProperty(r,t,a),a},s=function(e,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,r)},u=function(r,t,n,i){return new(n||(n=e))(function(e,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function l(e){try{s(i.throw(e))}catch(e){o(e)}}function s(r){r.done?e(r.value):new n(function(e){e(r.value)}).then(a,l)}s((i=i.apply(r,t||[])).next())})},c=function(e,r){var t,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(i=n[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=r.call(e,a)}catch(e){o=[6,e],n=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},p=function(){function e(e,t,n){this.authService=e,this.usersApi=t,this.validationControllerFactory=n,this.loading=!0,this.publicPhotoURL=null,this.imageError=!0,this.controller=n.createForCurrentScope(),this.controller.validateTrigger=a.validateTrigger.changeOrBlur,a.ValidationRules.ensure(function(e){return e.publicName}).displayName("Display Name").maxLength(r.MAX_NAME_LENGTH).required().ensure(function(e){return e.publicPhotoURL}).displayName("Photo url").matches(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/).withMessage("Photo url needs to be a valid image url").on(this)}return r=e,e.prototype.created=function(){return u(this,void 0,void 0,function(){var e,r;return c(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),[4,this.usersApi.getPublicUserInfo(this.authService.userId)];case 1:return e=t.sent(),r=e.data(),this.publicName=r.name,this.publicPhotoURL=r.photoURL,[3,4];case 2:return t.sent(),this.loadingError="There was an error loading your profile. Please try again later",[3,4];case 3:return this.loading=!1,[7];case 4:return[2]}})})},e.prototype.submit=function(){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:this.formState="loading",e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.usersApi.setPublicUserInfo(this.authService.userId,{name:this.publicName,photoURL:this.publicPhotoURL})];case 2:return e.sent(),this.formState="success",[3,4];case 3:return e.sent(),this.formState="error",[3,4];case 4:return[2]}})})},e.prototype.handleImageError=function(){this.imageError=!0},e.prototype.handleImageLoad=function(){this.imageError=!1},Object.defineProperty(e.prototype,"user",{get:function(){return this.authService.user},enumerable:!0,configurable:!0}),e.MAX_NAME_LENGTH=20,e=r=l([o.b,s("design:paramtypes",[i.a,n.a,a.ValidationControllerFactory])],e);var r}()}.call(this,t(11))},"resources/elements/profile-page.html":function(e,r,t){e.exports='<template>\n  <require from=\'./profile-page.scss\'></require>\n\n  <div if.bind=\'loading\' class="ui active inverted dimmer">\n    <div class="ui loader"></div>\n  </div>\n  <form class="ui form ${controller.errors.length ? \'error\' : \'\'} ${formState}" submit.delegate=\'submit()\'>\n    <div class="field required disabled">\n      <label>Email</label>\n      <input type="email" name="email" autocomplete=\'email\' value.bind=\'user.email\' placeholder="myemail@domain.com">\n    </div>\n    <div class=\'ui divider\'></div>\n    <h1>Public Info</h1>\n    <ul if.bind="formState !== \'error\' && controller.errors" class=\'ui error message\'>\n      <li repeat.for="error of controller.errors">\n        ${error.message}\n      </li>\n    </ul>\n    <div class=\'ui success message\'>\n      Your profile has been updated successfully.\n    </div>\n    <div class=\'ui error message\' if.bind=\'formState === "error"\'>\n      There was an error updating your profile. Please try again later.\n    </div>\n    <em>Info under this section is publicly visible on your contributions.</em>\n    <div class="field required">\n      <label>Display Name</label>\n      <input type="text" name="name" value.bind=\'publicName & debounce & validate\' placeholder="name" autocomplete=\'name\'>\n    </div>\n    <div class="field">\n      <label>Photo Url</label>\n      <input type="url" name="photoURL" value.bind=\'publicPhotoURL & debounce & validate\' placeholder="https://myprofilepic.jpg">\n      <img show.bind=\'!imageError\' class="ui circular image" src.bind="publicPhotoURL" error.trigger=\'handleImageError()\' load.trigger=\'handleImageLoad()\'>\n    </div>\n    <button class="ui button" type="submit">Submit</button>\n  </form>\n</template>\n'},"resources/elements/profile-page.scss":function(e,r,t){(e.exports=t(44)(!1)).push([e.i,".profile-page form {\n  text-align: left; }\n  .profile-page form img {\n    margin-top: 1em;\n    width: 6em;\n    height: 6em; }\n",""])}}]);
//# sourceMappingURL=profile.710fdfe2ec05005e40b1.bundle.map